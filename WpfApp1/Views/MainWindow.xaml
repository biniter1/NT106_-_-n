<Window x:Class="WpfApp1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:WpfApp1"
        xmlns:models="clr-namespace:WpfApp1.Models"
        xmlns:converters="clr-namespace:WpfApp1.Converters"
        xmlns:viewModels="clr-namespace:WpfApp1.ViewModels"
        xmlns:views="clr-namespace:WpfApp1.Views"
        mc:Ignorable="d"
        Title="{DynamicResource AppTitle}" Height="600" Width="1269"
        Background="#F5F5F5">
    <Window.Resources>
        <ResourceDictionary>

            <Style x:Key="SearchBoxPlaceholderStyle" TargetType="TextBox">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="TextBox">
                            <Grid>
                                <TextBlock Text="{DynamicResource SearchPlaceholderChat}"
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           Visibility="{Binding Text, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource StringNullOrEmptyToVisibilityConverter}}" />
                                <ScrollViewer x:Name="PART_ContentHost" Margin="0" />
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <DataTemplate DataType="{x:Type viewModels:MatchingChatViewModel}">
                <views:MatchingChatView/>
            </DataTemplate>
            
            <DataTemplate DataType="{x:Type viewModels:ChatViewModel}">
                <views:ChatView/>
            </DataTemplate>

            <DataTemplate DataType="{x:Type viewModels:FriendListViewModel}">
                <views:FriendListView />
            </DataTemplate>

            <DataTemplate DataType="{x:Type viewModels:SettingsViewModel}">
                <views:SettingsView/>
            </DataTemplate>
        </ResourceDictionary>
    </Window.Resources>

    <Grid x:Name="chatGrid">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="60"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Border Grid.Column="0" Background="{StaticResource Sidebar}" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,0">
            <StackPanel VerticalAlignment="Stretch" Margin="0, 10, 0, 0">
                <Button FontFamily="Segoe MDL2 Assets" Content="" ToolTip="{DynamicResource ProfileTooltip}"
                        Command="{Binding ShowChatMatchingCommand}" Width="40" Height="40" FontSize="18" Background="Transparent" Foreground="Gray" BorderThickness="0" Margin="5"/>

                <Button FontFamily="Segoe Fluent Icons" Content="" ToolTip="{DynamicResource MessageTooltip}"
                        Command="{Binding ShowChatCommand}" Width="40" Height="40" FontSize="18" Background="Transparent" Foreground="Gray" BorderThickness="0" Margin="5"/>

                <Button FontFamily="Segoe Fluent Icons" Content="" ToolTip="{DynamicResource FriendsTooltip}"
                        Command="{Binding ShowFriendListCommand}" Width="40" Height="40" FontSize="18" Background="Transparent" Foreground="Gray" BorderThickness="0" Margin="5"/>

                <Button FontFamily="Segoe MDL2 Assets" Content="" ToolTip="{DynamicResource SettingsTooltip}"
                        Command="{Binding ShowSettingsPopupCommand}" Width="40" Height="40" FontSize="18" Background="Transparent" Foreground="Gray" BorderThickness="0" Margin="5"/>
            </StackPanel>
        </Border>
        
        <ContentControl Grid.Column="1" Content="{Binding CurrentViewModel}"/>
        
        <Popup x:Name="MessageNotificationPopup"
               Placement="Top"
               PlacementTarget="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
               AllowsTransparency="True"
               PopupAnimation="Fade"
               HorizontalOffset="0"
               VerticalOffset="0"
               StaysOpen="False"
               Width="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=ActualWidth}"
               Height="Auto"
               >
            <Border Background="#202020" BorderBrush="#333333" BorderThickness="1" CornerRadius="5" Padding="10"
                    Margin="10"
                    >
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch" VerticalAlignment="Center">
                    <TextBlock x:Name="NotificationText"
                               TextWrapping="Wrap"
                               Foreground="White"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Left"
                               FontWeight="SemiBold"
                               Margin="0,0,10,0"
                               MouseLeftButtonDown="NotificationText_MouseLeftButtonDown"
                               Cursor="Hand"/>
                    <Button Content="X"
                            Style="{StaticResource CloseButtonStyle}"
                            Click="CloseNotification_Click"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            />
                </StackPanel>
            </Border>
        </Popup>
    </Grid>
</Window>